# gui/i18n.py
import locale
from config import settings # Import settings to get DEFAULT_LANGUAGE

STRINGS = {
    "es": {
        "title": "Suite de Transcripci√≥n",
        "about_title": "Informaci√≥n",
        "drag_drop_message": "üéµ Arrastra aqu√≠ tus archivos...",
        "file_already_loaded": "Ese archivo ya est√° cargado.",
        "loading_file_status": "Cargando: {filename}...",
        "playing_status": "Reproduciendo...",
        "paused_status": "Pausado.",
        "stopped_status": "Detenido.",
        "ready_status": "Listo",
        "error_status": "Error",
        "loading_status": "Cargando...",
        "finished_status": "Finalizado. Listo para \nreproducir.",
        "resuming_from_status": "Reanudando desde {minutes:02}:{seconds:02}...",
        "gain_label": "Ganancia (dB):",
        "volume_label": "Volumen:",
        "play_button": "Reproducir",
        "pause_button": "Pausar",
        "stop_button": "Detener",
        "load_file_button": "Cargar Archivo",
        "exit_button": "Salir",
        "rewind_button": "<<",
        "forward_button": ">>",
        "hotkey_conn_lost": "Se ha perdido la conexi√≥n con el servidor de hotkeys.",
        "hotkey_server_failed_start": "No se pudo iniciar el servidor de hotkeys. La aplicaci√≥n se ejecutar√° sin soporte para hotkeys globales.",
        "hotkey_server_failed_connect": "No se pudo conectar al servidor de hotkeys despu√©s de varios intentos. La aplicaci√≥n se ejecutar√° sin hotkeys globales.",
        "privilege_elevation_windows_only": "La elevaci√≥n de privilegios solo es compatible con Windows.",
        "hotkey_conn_broken_reconnecting": "La conexi√≥n con la UI se ha roto. Intentando reconectar...",
        "hotkey_command_failed_no_conn_or_media": "Se intent√≥ enviar el comando '{command}' pero la conexi√≥n no est√° activa o no hay medio cargado.",
        "hotkey_media_loaded_activated": "Medio cargado en la UI. Hotkeys de reproducci√≥n activadas.",
        "hotkey_media_unloaded_deactivated": "Medio descargado de la UI. Hotkeys de reproducci√≥n desactivadas.",
        "hotkey_ui_closing_server_terminating": "La UI ha notificado el cierre. Terminando servidor.",
        "hotkey_ui_disconnected": "El cliente de la UI se ha desconectado.",
        "hotkey_server_starting": "Iniciando servidor de hotkeys...",
        "hotkey_server_listening_on": "Servidor escuchando en {address_ip}:{address_port}",
        "hotkey_waiting_for_ui_conn": "Esperando conexi√≥n de la UI...",
        "hotkey_ui_connected_from": "¬°UI conectada desde {last_accepted_address}!",
        "hotkey_server_loop_error": "Error en el bucle del servidor: {error_message}",
        "hotkey_server_stopped": "Servidor de hotkeys detenido.",
        "hotkey_admin_required_critical": "¬°ERROR! Este script debe ejecutarse como Administrador para capturar las hotkeys globales.",
        "hotkey_keyboard_interrupt": "Interrupci√≥n por teclado recibida. Cerrando servidor...",
        "hotkey_fatal_error": "Ha ocurrido un error fatal en el servidor: {error_message}",
        "about_developer_info": "Desarrollado por: \nPablo T√©llez A.\n\nTarija - 2026.",
        "close_button": "Cerrar",
        "hotkeys_keyboard_loaded": "Librer√≠a 'keyboard' cargada din√°micamente.",
        "hotkeys_keyboard_import_failed": "No se pudo importar la librer√≠a 'keyboard'. Las hotkeys no funcionar√°n. Error: {error_message}",
        "hotkeys_clear_failed": "No se pudieron limpiar las hotkeys existentes: {error_message}. Continuando...",
        "hotkeys_press_registered": "Hotkey de pulsaci√≥n registrada para '{key}'.",
        "hotkeys_release_registered": "Hotkey de liberaci√≥n registrada para '{key}'.",
        "hotkeys_all_registered": "Todas las hotkeys han sido registradas en modo de supresi√≥n individual.",
        "hotkeys_critical_registration_failed": "FALLO CR√çTICO al registrar las hotkeys: {error_message}",
        "hotkeys_all_stopped_released": "Todas las hotkeys globales han sido detenidas y liberadas.",
        "hotkeys_stop_failed_not_loaded": "Se intent√≥ detener HotkeyManager, pero la librer√≠a 'keyboard' no estaba cargada.",
        "hotkeys_callback_error": "Error al ejecutar el callback de la hotkey: {error_message}",
        "hotkey_sending_command": "Enviando comando: '{command}'",
        "ui_connecting_to_hotkey_server": "Intentando conectar al servidor de hotkeys (Intento {attempt}/{max_attempts})...",
        "ui_hotkey_server_connected": "¬°Conexi√≥n establecida con el servidor de hotkeys!",
        "ui_hotkey_elevation_request": "Solicitud de elevaci√≥n para 'hotkey_server.py' enviada al sistema operativo (UAC).",
        "ui_hotkey_elevation_failed": "Fallo al intentar elevar 'hotkey_server.py'. C√≥digo de error de ShellExecuteW: {error_code}",
        "ui_hotkey_launch_fatal_error": "Error fatal al intentar lanzar el servidor como administrador: {error_message}",
        "ui_scale_factor_set": "Factor de escala de la UI establecido a: {scale_factor:.2f}"
    },
    "en": {
        "title": "Transcription Suite",
        "about_title": "About",
        "drag_drop_message": "üéµ Drag your files here...",
        "file_already_loaded": "That file is already loaded.",
        "loading_file_status": "Loading: {filename}...",
        "playing_status": "Playing...",
        "paused_status": "Paused.",
        "stopped_status": "Stopped.",
        "ready_status": "Ready",
        "error_status": "Error",
        "loading_status": "Loading...",
        "finished_status": "Finished. Ready to \nplay.",
        "resuming_from_status": "Resuming from {minutes:02}:{seconds:02}...",
        "gain_label": "Gain (dB):",
        "volume_label": "Volume:",
        "play_button": "Play",
        "pause_button": "Pause",
        "stop_button": "Stop",
        "load_file_button": "Load File",
        "exit_button": "Exit",
        "rewind_button": "<<",
        "forward_button": ">>",
        "hotkey_conn_lost": "Lost connection to hotkey server.",
        "hotkey_server_failed_start": "Hotkey server failed to start. Application will run without global hotkeys.",
        "hotkey_server_failed_connect": "Could not connect to hotkey server after several attempts. Application will run without global hotkeys.",
        "privilege_elevation_windows_only": "Privilege elevation is only supported on Windows.",
        "hotkey_conn_broken_reconnecting": "UI connection broken. Attempting to reconnect...",
        "hotkey_command_failed_no_conn_or_media": "Attempted to send command '{command}' but connection not active or no media loaded.",
        "hotkey_media_loaded_activated": "Media loaded in UI. Playback hotkeys activated.",
        "hotkey_media_unloaded_deactivated": "Media unloaded from UI. Playback hotkeys deactivated.",
        "hotkey_ui_closing_server_terminating": "UI reported closing. Terminating server.",
        "hotkey_ui_disconnected": "UI client disconnected.",
        "hotkey_server_starting": "Starting hotkey server...",
        "hotkey_server_listening_on": "Server listening on {address_ip}:{address_port}",
        "hotkey_waiting_for_ui_conn": "Waiting for UI connection...",
        "hotkey_ui_connected_from": "UI connected from {last_accepted_address}!",
        "hotkey_server_loop_error": "Error in server loop: {error_message}",
        "hotkey_server_stopped": "Hotkey server stopped.",
        "hotkey_admin_required_critical": "ERROR! This script must be run as Administrator to capture global hotkeys.",
        "hotkey_keyboard_interrupt": "Keyboard interrupt received. Closing server...",
        "hotkey_fatal_error": "A fatal error occurred in the server: {error_message}",
        "about_developer_info": "Developed by: \nPablo T√©llez A.\n\nTarija - 2026.",
        "close_button": "Close",
        "hotkeys_keyboard_loaded": "Keyboard library loaded dynamically.",
        "hotkeys_keyboard_import_failed": "Could not import 'keyboard' library. Hotkeys will not work. Error: {error_message}",
        "hotkeys_clear_failed": "Could not clear existing hotkeys: {error_message}. Continuing...",
        "hotkeys_press_registered": "Press hotkey registered for '{key}'.",
        "hotkeys_release_registered": "Release hotkey registered for '{key}'.",
        "hotkeys_all_registered": "All hotkeys have been registered in individual suppression mode.",
        "hotkeys_critical_registration_failed": "CRITICAL FAILURE registering hotkeys: {error_message}",
        "hotkeys_all_stopped_released": "All global hotkeys have been stopped and released.",
        "hotkeys_stop_failed_not_loaded": "Attempted to stop HotkeyManager, but 'keyboard' library was not loaded.",
        "hotkeys_callback_error": "Error executing hotkey callback: {error_message}",
        "hotkey_sending_command": "Sending command: '{command}'",
        "ui_connecting_to_hotkey_server": "Attempting to connect to hotkey server (Attempt {attempt}/{max_attempts})...",
        "ui_hotkey_server_connected": "Connection established with hotkey server!",
        "ui_hotkey_elevation_request": "Elevation request for 'hotkey_server.py' sent to OS (UAC).",
        "ui_hotkey_elevation_failed": "Failed to elevate 'hotkey_server.py'. ShellExecuteW error code: {error_code}",
        "ui_hotkey_launch_fatal_error": "Fatal error attempting to launch server as admin: {error_message}",
        "ui_scale_factor_set": "UI scale factor set to: {scale_factor:.2f}"
    },
    "fr": {
        "title": "Suite de Transcription",
        "about_title": "√Ä propos",
        "drag_drop_message": "üéµ Glissez vos fichiers ici...",
        "file_already_loaded": "Ce fichier est d√©j√† charg√©.",
        "loading_file_status": "Chargement : {filename}...",
        "playing_status": "Lecture...",
        "paused_status": "En pause.",
        "stopped_status": "Arr√™t√©.",
        "ready_status": "Pr√™t",
        "error_status": "Erreur",
        "loading_status": "Chargement...",
        "finished_status": "Termin√©. Pr√™t √† \njouer.",
        "resuming_from_status": "Reprise √† {minutes:02}:{seconds:02}...",
        "gain_label": "Gain (dB):",
        "volume_label": "Volume:",
        "play_button": "Lire",
        "pause_button": "Pause",
        "stop_button": "Arr√™ter",
        "load_file_button": "Charger Fichier",
        "exit_button": "Quitter",
        "rewind_button": "<<",
        "forward_button": ">>",
        "hotkey_conn_lost": "Connexion perdue avec le serveur de raccourcis.",
        "hotkey_server_failed_start": "Le serveur de raccourcis n'a pas pu d√©marrer. L'application fonctionnera sans raccourcis globaux.",
        "hotkey_server_failed_connect": "Impossible de se connecter au serveur de raccourcis apr√®s plusieurs tentatives. L'application fonctionnera sans raccourcis globaux.",
        "privilege_elevation_windows_only": "L'√©l√©vation de privil√®ges n'est prise en charge que sur Windows.",
        "hotkey_conn_broken_reconnecting": "La connexion avec l'interface utilisateur est rompue. Tentative de reconnexion...",
        "hotkey_command_failed_no_conn_or_media": "Tentative d'envoi de la commande '{command}' mais la connexion n'est pas active ou aucun m√©dia n'est charg√©.",
        "hotkey_media_loaded_activated": "M√©dia charg√© dans l'interface utilisateur. Raccourcis de lecture activ√©s.",
        "hotkey_media_unloaded_deactivated": "M√©dia d√©charg√© de l'interface utilisateur. Raccourcis de lecture d√©sactiv√©s.",
        "hotkey_ui_closing_server_terminating": "L'interface utilisateur a signal√© sa fermeture. Arr√™t du serveur.",
        "hotkey_ui_disconnected": "Le client de l'interface utilisateur s'est d√©connect√©.",
        "hotkey_server_starting": "D√©marrage du serveur de raccourcis...",
        "hotkey_server_listening_on": "Serveur √† l'√©coute sur {address_ip}:{address_port}",
        "hotkey_waiting_for_ui_conn": "En attente de la connexion de l'interface utilisateur...",
        "hotkey_ui_connected_from": "Interface utilisateur connect√©e depuis {last_accepted_address}!",
        "hotkey_server_loop_error": "Erreur dans la boucle du serveur : {error_message}",
        "hotkey_server_stopped": "Serveur de raccourcis arr√™t√©.",
        "hotkey_admin_required_critical": "ERREUR ! Ce script doit √™tre ex√©cut√© en tant qu'administrateur pour capturer les raccourcis globaux.",
        "hotkey_keyboard_interrupt": "Interruption clavier re√ßue. Fermeture du serveur...",
        "hotkey_fatal_error": "Une erreur fatale est survenue dans le serveur : {error_message}",
        "about_developer_info": "D√©velopp√© par : \nPablo T√©llez A.\n\nTarija - 2026.",
        "close_button": "Fermer",
        "hotkeys_keyboard_loaded": "Biblioth√®que 'keyboard' charg√©e dynamiquement.",
        "hotkeys_keyboard_import_failed": "Impossible d'importer la biblioth√®que 'keyboard'. Les raccourcis ne fonctionneront pas. Erreur : {error_message}",
        "hotkeys_clear_failed": "Impossible de supprimer les raccourcis existants : {error_message}. Continuation...",
        "hotkeys_press_registered": "Raccourci de pression enregistr√© pour '{key}'.",
        "hotkeys_release_registered": "Raccourci de rel√¢chement enregistr√© pour '{key}'.",
        "hotkeys_all_registered": "Tous les raccourcis ont √©t√© enregistr√©s en mode de suppression individuelle.",
        "hotkeys_critical_registration_failed": "√âCHEC CRITIQUE lors de l'enregistrement des raccourcis : {error_message}",
        "hotkeys_all_stopped_released": "Tous les raccourcis globaux ont √©t√© arr√™t√©s et lib√©r√©s.",
        "hotkeys_stop_failed_not_loaded": "Tentative d'arr√™t de HotkeyManager, mais la biblioth√®que 'keyboard' n'√©tait pas charg√©e.",
        "hotkeys_callback_error": "Erreur lors de l'ex√©cution du rappel du raccourci : {error_message}",
        "hotkey_sending_command": "Envoi de la commande : '{command}'",
        "ui_connecting_to_hotkey_server": "Tentative de connexion au serveur de raccourcis (Tentative {attempt}/{max_attempts})...",
        "ui_hotkey_server_connected": "Connexion √©tablie avec le serveur de raccourcis !",
        "ui_hotkey_elevation_request": "Demande d'√©l√©vation pour 'hotkey_server.py' envoy√©e au SE (UAC).",
        "ui_hotkey_elevation_failed": "√âchec de l'√©l√©vation de 'hotkey_server.py'. Code d'erreur ShellExecuteW : {error_code}",
        "ui_hotkey_launch_fatal_error": "Erreur fatale lors de la tentative de lancement du serveur en tant qu'administrateur : {error_message}",
        "ui_scale_factor_set": "Facteur d'√©chelle de l'interface utilisateur d√©fini sur : {scale_factor:.2f}"
    },
    "de": {
        "title": "Transkriptionssuite",
        "about_title": "√úber",
        "drag_drop_message": "üéµ Ziehen Sie Ihre Dateien hierher...",
        "file_already_loaded": "Diese Datei ist bereits geladen.",
        "loading_file_status": "Lade: {filename}...",
        "playing_status": "Wiedergabe...",
        "paused_status": "Pausiert.",
        "stopped_status": "Gestoppt.",
        "ready_status": "Bereit",
        "error_status": "Fehler",
        "loading_status": "Laden...",
        "finished_status": "Fertig. Bereit zur \nWiedergabe.",
        "resuming_from_status": "Fortsetzen ab {minutes:02}:{seconds:02}...",
        "gain_label": "Verst√§rkung (dB):",
        "volume_label": "Lautst√§rke:",
        "play_button": "Abspielen",
        "pause_button": "Pause",
        "stop_button": "Stopp",
        "load_file_button": "Datei laden",
        "exit_button": "Beenden",
        "rewind_button": "<<",
        "forward_button": ">>",
        "hotkey_conn_lost": "Verbindung zum Hotkey-Server verloren.",
        "hotkey_server_failed_start": "Hotkey-Server konnte nicht gestartet werden. Die Anwendung wird ohne globale Hotkeys ausgef√ºhrt.",
        "hotkey_server_failed_connect": "Nach mehreren Versuchen konnte keine Verbindung zum Hotkey-Server hergestellt werden. Die Anwendung wird ohne globale Hotkeys ausgef√ºhrt.",
        "privilege_elevation_windows_only": "Rechteerweiterung wird nur unter Windows unterst√ºtzt.",
        "hotkey_conn_broken_reconnecting": "Verbindung zur Benutzeroberfl√§che unterbrochen. Versuche erneut zu verbinden...",
        "hotkey_command_failed_no_conn_or_media": "Befehl '{command}' konnte nicht gesendet werden, da keine Verbindung aktiv ist oder keine Medien geladen sind.",
        "hotkey_media_loaded_activated": "Medien in der Benutzeroberfl√§che geladen. Wiedergabe-Hotkeys aktiviert.",
        "hotkey_media_unloaded_deactivated": "Medien aus der Benutzeroberfl√§che entfernt. Wiedergabe-Hotkeys deaktiviert.",
        "hotkey_ui_closing_server_terminating": "Benutzeroberfl√§che hat Schlie√üung gemeldet. Server wird beendet.",
        "hotkey_ui_disconnected": "Client der Benutzeroberfl√§che hat die Verbindung getrennt.",
        "hotkey_server_starting": "Hotkey-Server wird gestartet...",
        "hotkey_server_listening_on": "Server lauscht auf {address_ip}:{address_port}",
        "hotkey_waiting_for_ui_conn": "Warte auf Verbindung der Benutzeroberfl√§che...",
        "hotkey_ui_connected_from": "Benutzeroberfl√§che verbunden von {last_accepted_address}!",
        "hotkey_server_loop_error": "Fehler in der Serverschleife: {error_message}",
        "hotkey_server_stopped": "Hotkey-Server gestoppt.",
        "hotkey_admin_required_critical": "FEHLER! Dieses Skript muss als Administrator ausgef√ºhrt werden, um globale Hotkeys zu erfassen.",
        "hotkey_keyboard_interrupt": "Tastaturunterbrechung empfangen. Server wird geschlossen...",
        "hotkey_fatal_error": "Ein fataler Fehler ist im Server aufgetreten: {error_message}",
        "about_developer_info": "Entwickelt von: \nPablo T√©llez A.\n\nTarija - 2026.",
        "close_button": "Schlie√üen",
        "hotkeys_keyboard_loaded": "Tastatur-Bibliothek dynamisch geladen.",
        "hotkeys_keyboard_import_failed": "Die 'keyboard'-Bibliothek konnte nicht importiert werden. Hotkeys funktionieren nicht. Fehler: {error_message}",
        "hotkeys_clear_failed": "Bestehende Hotkeys konnten nicht gel√∂scht werden: {error_message}. Fortsetzung...",
        "hotkeys_press_registered": "Druck-Hotkey f√ºr '{key}' registriert.",
        "hotkeys_release_registered": "Loslass-Hotkey f√ºr '{key}' registriert.",
        "hotkeys_all_registered": "Alle Hotkeys wurden im individuellen Unterdr√ºckungsmodus registriert.",
        "hotkeys_critical_registration_failed": "KRITISCHER FEHLER beim Registrieren der Hotkeys: {error_message}",
        "hotkeys_all_stopped_released": "Alle globalen Hotkeys wurden gestoppt und freigegeben.",
        "hotkeys_stop_failed_not_loaded": "Versuch, HotkeyManager zu stoppen, aber die 'keyboard'-Bibliothek war nicht geladen.",
        "hotkeys_callback_error": "Fehler beim Ausf√ºhren des Hotkey-Callbacks: {error_message}",
        "hotkey_sending_command": "Sende Befehl: '{command}'",
        "ui_connecting_to_hotkey_server": "Versuche, eine Verbindung zum Hotkey-Server herzustellen (Versuch {attempt}/{max_attempts})...",
        "ui_hotkey_server_connected": "Verbindung mit dem Hotkey-Server hergestellt!",
        "ui_hotkey_elevation_request": "Rechteerweiterungsanforderung f√ºr 'hotkey_server.py' an das Betriebssystem (UAC) gesendet.",
        "ui_hotkey_elevation_failed": "Fehler bei der Rechteerweiterung von 'hotkey_server.py'. ShellExecuteW-Fehlercode: {error_code}",
        "ui_hotkey_launch_fatal_error": "Fataler Fehler beim Versuch, den Server als Administrator zu starten: {error_message}",
        "ui_scale_factor_set": "Skalierungsfaktor der Benutzeroberfl√§che auf {scale_factor:.2f} gesetzt."
    },
    "pt": {
        "title": "Suite de Transcri√ß√£o",
        "about_title": "Sobre",
        "drag_drop_message": "üéµ Arraste seus arquivos aqui...",
        "file_already_loaded": "Esse arquivo j√° foi carregado.",
        "loading_file_status": "Carregando: {filename}...",
        "playing_status": "Reproduzindo...",
        "paused_status": "Pausado.",
        "stopped_status": "Parado.",
        "ready_status": "Pronto",
        "error_status": "Erro",
        "loading_status": "Carregando...",
        "finished_status": "Finalizado. Pronto para \nreproduzir.",
        "resuming_from_status": "Retomando de {minutes:02}:{seconds:02}...",
        "gain_label": "Ganho (dB):",
        "volume_label": "Volume:",
        "play_button": "Reproduzir",
        "pause_button": "Pausar",
        "stop_button": "Parar",
        "load_file_button": "Carregar Arquivo",
        "exit_button": "Sair",
        "rewind_button": "<<",
        "forward_button": ">>",
        "hotkey_conn_lost": "Conex√£o perdida com o servidor de teclas de atalho.",
        "hotkey_server_failed_start": "O servidor de teclas de atalho n√£o p√¥de ser iniciado. O aplicativo ser√° executado sem teclas de atalho globais.",
        "hotkey_server_failed_connect": "N√£o foi poss√≠vel conectar ao servidor de teclas de atalho ap√≥s v√°rias tentativas. O aplicativo ser√° executado sem teclas de atalho globais.",
        "privilege_elevation_windows_only": "A eleva√ß√£o de privil√©gios √© suportada apenas no Windows.",
        "hotkey_conn_broken_reconnecting": "A conex√£o com a interface do usu√°rio foi interrompida. Tentando reconectar...",
        "hotkey_command_failed_no_conn_or_media": "Tentativa de enviar o comando '{command}', mas a conex√£o n√£o est√° ativa ou nenhuma m√≠dia foi carregada.",
        "hotkey_media_loaded_activated": "M√≠dia carregada na interface do usu√°rio. Teclas de atalho de reprodu√ß√£o ativadas.",
        "hotkey_media_unloaded_deactivated": "M√≠dia descarregada da interface do usu√°rio. Teclas de atalho de reprodu√ß√£o desativadas.",
        "hotkey_ui_closing_server_terminating": "A interface do usu√°rio informou o fechamento. Encerrando o servidor.",
        "hotkey_ui_disconnected": "O cliente da interface do usu√°rio se desconectou.",
        "hotkey_server_starting": "Iniciando servidor de teclas de atalho...",
        "hotkey_server_listening_on": "Servidor escutando em {address_ip}:{address_port}",
        "hotkey_waiting_for_ui_conn": "Aguardando conex√£o da interface do usu√°rio...",
        "hotkey_ui_connected_from": "Interface do usu√°rio conectada de {last_accepted_address}!",
        "hotkey_server_loop_error": "Erro no loop do servidor: {error_message}",
        "hotkey_server_stopped": "Servidor de teclas de atalho parado.",
        "hotkey_admin_required_critical": "ERRO! Este script deve ser executado como Administrador para capturar as teclas de atalho globais.",
        "hotkey_keyboard_interrupt": "Interrup√ß√£o do teclado recebida. Fechando o servidor...",
        "hotkey_fatal_error": "Ocorreu um erro fatal no servidor: {error_message}",
        "about_developer_info": "Desenvolvido por: \nPablo T√©llez A.\n\nTarija - 2026.",
        "close_button": "Fechar",
        "hotkeys_keyboard_loaded": "Biblioteca 'keyboard' carregada dinamicamente.",
        "hotkeys_keyboard_import_failed": "N√£o foi poss√≠vel importar a biblioteca 'keyboard'. As teclas de atalho n√£o funcionar√£o. Erro: {error_message}",
        "hotkeys_clear_failed": "N√£o foi poss√≠vel limpar as teclas de atalho existentes: {error_message}. Continuando...",
        "hotkeys_press_registered": "Tecla de atalho de pressionar registrada para '{key}'.",
        "hotkeys_release_registered": "Tecla de atalho de soltar registrada para '{key}'.",
        "hotkeys_all_registered": "Todas as teclas de atalho foram registradas no modo de supress√£o individual.",
        "hotkeys_critical_registration_failed": "FALHA CR√çTICA ao registrar as teclas de atalho: {error_message}",
        "hotkeys_all_stopped_released": "Todas as teclas de atalho globais foram paradas e liberadas.",
        "hotkeys_stop_failed_not_loaded": "Tentativa de parar o HotkeyManager, mas a biblioteca 'keyboard' n√£o estava carregada.",
        "hotkeys_callback_error": "Erro ao executar o retorno de chamada da tecla de atalho: {error_message}",
        "hotkey_sending_command": "Enviando comando: '{command}'",
        "ui_connecting_to_hotkey_server": "Tentando conectar ao servidor de teclas de atalho (Tentativa {attempt}/{max_attempts})...",
        "ui_hotkey_server_connected": "Conex√£o estabelecida com o servidor de teclas de atalho!",
        "ui_hotkey_elevation_request": "Solicita√ß√£o de eleva√ß√£o para 'hotkey_server.py' enviada ao SO (UAC).",
        "ui_hotkey_elevation_failed": "Falha ao elevar 'hotkey_server.py'. C√≥digo de erro ShellExecuteW: {error_code}",
        "ui_hotkey_launch_fatal_error": "Erro fatal ao tentar iniciar o servidor como administrador: {error_message}",
        "ui_scale_factor_set": "Fator de escala da UI definido para: {scale_factor:.2f}"
    },
    "it": {
        "title": "Suite di Trascrizione",
        "about_title": "Informazioni",
        "drag_drop_message": "üéµ Trascina qui i tuoi file...",
        "file_already_loaded": "Questo file √® gi√† caricato.",
        "loading_file_status": "Caricamento: {filename}...",
        "playing_status": "In riproduzione...",
        "paused_status": "In pausa.",
        "stopped_status": "Fermato.",
        "ready_status": "Pronto",
        "error_status": "Errore",
        "loading_status": "Caricamento...",
        "finished_status": "Finito. Pronto per la \nriproduzione.",
        "resuming_from_status": "Riprendendo da {minutes:02}:{seconds:02}...",
        "gain_label": "Guadagno (dB):",
        "volume_label": "Volume:",
        "play_button": "Riproduci",
        "pause_button": "Pausa",
        "stop_button": "Ferma",
        "load_file_button": "Carica File",
        "exit_button": "Esci",
        "rewind_button": "<<",
        "forward_button": ">>",
        "hotkey_conn_lost": "Connessione persa con il server degli hotkey.",
        "hotkey_server_failed_start": "Impossibile avviare il server degli hotkey. L'applicazione verr√† eseguita senza hotkey globali.",
        "hotkey_server_failed_connect": "Impossibile connettersi al server degli hotkey dopo diversi tentativi. L'applicazione verr√† eseguita senza hotkey globali.",
        "privilege_elevation_windows_only": "L'elevazione dei privilegi √® supportata solo su Windows.",
        "hotkey_conn_broken_reconnecting": "Connessione con l'interfaccia utente interrotta. Tentativo di riconnessione...",
        "hotkey_command_failed_no_conn_or_media": "Tentativo di inviare il comando '{command}' ma la connessione non √® attiva o nessun media √® caricato.",
        "hotkey_media_loaded_activated": "Media caricato nell'interfaccia utente. Hotkey di riproduzione attivati.",
        "hotkey_media_unloaded_deactivated": "Media scaricato dall'interfaccia utente. Hotkey di riproduzione disattivati.",
        "hotkey_ui_closing_server_terminating": "L'interfaccia utente ha segnalato la chiusura. Chiusura del server.",
        "hotkey_ui_disconnected": "Il client dell'interfaccia utente si √® disconnesso.",
        "hotkey_server_starting": "Avvio del server degli hotkey...",
        "hotkey_server_listening_on": "Server in ascolto su {address_ip}:{address_port}",
        "hotkey_waiting_for_ui_conn": "In attesa di connessione dall'interfaccia utente...",
        "hotkey_ui_connected_from": "Interfaccia utente connessa da {last_accepted_address}!",
        "hotkey_server_loop_error": "Errore nel ciclo del server: {error_message}",
        "hotkey_server_stopped": "Server degli hotkey arrestato.",
        "hotkey_admin_required_critical": "ERRORE! Questo script deve essere eseguito come Amministratore per catturare gli hotkey globali.",
        "hotkey_keyboard_interrupt": "Interruzione da tastiera ricevuta. Chiusura del server...",
        "hotkey_fatal_error": "Si √® verificato un errore fatale nel server: {error_message}",
        "about_developer_info": "Sviluppato da: \nPablo T√©llez A.\n\nTarija - 2026.",
        "close_button": "Chiudi",
        "hotkeys_keyboard_loaded": "Libreria 'keyboard' caricata dinamicamente.",
        "hotkeys_keyboard_import_failed": "Impossibile importare la libreria 'keyboard'. Gli hotkey non funzioneranno. Errore: {error_message}",
        "hotkeys_clear_failed": "Impossibile cancellare gli hotkey esistenti: {error_message}. Continuazione...",
        "hotkeys_press_registered": "Hotkey di pressione registrato per '{key}'.",
        "hotkeys_release_registered": "Hotkey di rilascio registrato per '{key}'.",
        "hotkeys_all_registered": "Tutti gli hotkey sono stati registrati in modalit√† di soppressione individuale.",
        "hotkeys_critical_registration_failed": "FALLIMENTO CRITICO nella registrazione degli hotkey: {error_message}",
        "hotkeys_all_stopped_released": "Tutti gli hotkey globali sono stati arrestati e rilasciati.",
        "hotkeys_stop_failed_not_loaded": "Tentativo di arrestare HotkeyManager, ma la libreria 'keyboard' non era caricata.",
        "hotkeys_callback_error": "Errore durante l'esecuzione del callback dell'hotkey: {error_message}",
        "hotkey_sending_command": "Invio comando: '{command}'",
        "ui_connecting_to_hotkey_server": "Tentativo di connessione al server degli hotkey (Tentativo {attempt}/{max_attempts})...",
        "ui_hotkey_server_connected": "Connessione stabilita con il server degli hotkey!",
        "ui_hotkey_elevation_request": "Richiesta di elevazione per 'hotkey_server.py' inviata al sistema operativo (UAC).",
        "ui_hotkey_elevation_failed": "Impossibile elevare 'hotkey_server.py'. Codice di errore ShellExecuteW: {error_code}",
        "ui_hotkey_launch_fatal_error": "Errore fatale durante il tentativo di avviare il server come amministratore: {error_message}",
        "ui_scale_factor_set": "Fattore di scala dell'interfaccia utente impostato su: {scale_factor:.2f}"
    }
}

def get_system_language():
    lang, _ = locale.getdefaultlocale()
    if not lang:
        return settings.DEFAULT_LANGUAGE
    return lang.split("_")[0]

SYSTEM_LANG = get_system_language()

# Ensure the system language is in our STRINGS dictionary, otherwise use default
UI_LANG = SYSTEM_LANG if SYSTEM_LANG in STRINGS else settings.DEFAULT_LANGUAGE

def tr(translation_key, **kwargs):
    """
    Translates the given key based on the active UI language.
    Supports f-string style formatting for dynamic values.
    """
    # Get the translation, falling back to the key itself if not found
    translated_string = STRINGS[UI_LANG].get(translation_key, translation_key)
    # Apply f-string formatting if kwargs are provided
    if kwargs:
        try:
            return translated_string.format(**kwargs)
        except KeyError:
            # Handle cases where format keys in kwargs don't match placeholders in translated_string
            return translated_string
    return translated_string